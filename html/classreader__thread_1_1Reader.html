<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LogViewer: reader_thread.Reader Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LogViewer
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>reader_thread</b></li><li class="navelem"><a class="el" href="classreader__thread_1_1Reader.html">Reader</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classreader__thread_1_1Reader-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">reader_thread.Reader Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for reader_thread.Reader:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classreader__thread_1_1Reader.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a81ae8debea3697456ae84b58bd643b52"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreader__thread_1_1Reader.html#a81ae8debea3697456ae84b58bd643b52">__init__</a> (self, name, file)</td></tr>
<tr class="separator:a81ae8debea3697456ae84b58bd643b52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1515866339e6d6609bc73a7f491acb5a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreader__thread_1_1Reader.html#a1515866339e6d6609bc73a7f491acb5a">run</a> (self)</td></tr>
<tr class="separator:a1515866339e6d6609bc73a7f491acb5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af60097f7d3b9fc39d4ee1bf28bc55e44"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreader__thread_1_1Reader.html#af60097f7d3b9fc39d4ee1bf28bc55e44">read_file_in_xfrl_mode</a> (self)</td></tr>
<tr class="separator:af60097f7d3b9fc39d4ee1bf28bc55e44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a047f01b347af7b675e41229fa42049be"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreader__thread_1_1Reader.html#a047f01b347af7b675e41229fa42049be">read_file_in_std_mode</a> (self)</td></tr>
<tr class="separator:a047f01b347af7b675e41229fa42049be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd599dfaed799e24698b15b3dc44dc01"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreader__thread_1_1Reader.html#abd599dfaed799e24698b15b3dc44dc01">parse_new_line_xfrl</a> (self, line, old_request)</td></tr>
<tr class="separator:abd599dfaed799e24698b15b3dc44dc01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51d8ba12d213d2f73c30afdf77197a3d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreader__thread_1_1Reader.html#a51d8ba12d213d2f73c30afdf77197a3d">parse_new_line_std</a> (self, line, old_request)</td></tr>
<tr class="separator:a51d8ba12d213d2f73c30afdf77197a3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7c1fa6769c40fab07cd81ec5f009c55"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreader__thread_1_1Reader.html#af7c1fa6769c40fab07cd81ec5f009c55">check_log_type</a> (self)</td></tr>
<tr class="separator:af7c1fa6769c40fab07cd81ec5f009c55"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a8a0e9bc7ab6d23442cd90ddefd6df4bd"><td class="memItemLeft" align="right" valign="top"><a id="a8a0e9bc7ab6d23442cd90ddefd6df4bd"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>db</b></td></tr>
<tr class="separator:a8a0e9bc7ab6d23442cd90ddefd6df4bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40531117d5bfb671f505bdcd914dce7e"><td class="memItemLeft" align="right" valign="top"><a id="a40531117d5bfb671f505bdcd914dce7e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>name</b></td></tr>
<tr class="separator:a40531117d5bfb671f505bdcd914dce7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6defcad361e2f258ae0370738d57ea85"><td class="memItemLeft" align="right" valign="top"><a id="a6defcad361e2f258ae0370738d57ea85"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>file</b></td></tr>
<tr class="separator:a6defcad361e2f258ae0370738d57ea85"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Represent the file-reader of the system
Attributes:
    -name: name of the file, useful to identify to which server has been done a request
    -file: represent the actual log file to read
</pre> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a81ae8debea3697456ae84b58bd643b52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81ae8debea3697456ae84b58bd643b52">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def reader_thread.Reader.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This class will run the reading process from the log file.
There are 2 attributes needed:
-name: name of the vsftpd file log, used for identify the file
-file: file object where the log are stored
</pre> 
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="af7c1fa6769c40fab07cd81ec5f009c55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7c1fa6769c40fab07cd81ec5f009c55">&#9670;&nbsp;</a></span>check_log_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def reader_thread.Reader.check_log_type </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method will check in the first line of the log if it contains any of this specific words: CONNECT,
OK LOGIN, OK UPLOAD, FAIL DOWNLOAD, OK DOWNLOAD. If any of this words is inside the log line so the log is NOT
in xferlog standard mode. This method will return true if the log is in xferlog standard mode, false in any
other case
</pre> 
</div>
</div>
<a id="a51d8ba12d213d2f73c30afdf77197a3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51d8ba12d213d2f73c30afdf77197a3d">&#9670;&nbsp;</a></span>parse_new_line_std()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def reader_thread.Reader.parse_new_line_std </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>old_request</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method will analise the new line of the log file (which is in standard mode), if a download is found it
will, create an object Request_std and add the new request to the database if is a new one.
</pre> 
</div>
</div>
<a id="abd599dfaed799e24698b15b3dc44dc01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd599dfaed799e24698b15b3dc44dc01">&#9670;&nbsp;</a></span>parse_new_line_xfrl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def reader_thread.Reader.parse_new_line_xfrl </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>old_request</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method will analise the new line of the log file (which is in xferlog standard mode), if a download
is found it will, create an object Request_xfrl and add the new request to the database if is a new one.
</pre> 
</div>
</div>
<a id="a047f01b347af7b675e41229fa42049be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a047f01b347af7b675e41229fa42049be">&#9670;&nbsp;</a></span>read_file_in_std_mode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def reader_thread.Reader.read_file_in_std_mode </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method consist in a while True which will constantly check the log file (in standard mode to see if
there is new entry. If not the thread will sleep for 3 seconds, although it will parse the request.
Is possible that Kodi will do more than 1 request for the same file. To prevent that the script will save the
same request more than once, the last request is saved and is compered with the new one. A request is new
if is different from the previous one or if is pass at least 10 seconds from the previous one.
</pre> 
</div>
</div>
<a id="af60097f7d3b9fc39d4ee1bf28bc55e44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af60097f7d3b9fc39d4ee1bf28bc55e44">&#9670;&nbsp;</a></span>read_file_in_xfrl_mode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def reader_thread.Reader.read_file_in_xfrl_mode </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This method consist in a while True which will constantly check the log file (in xfrelog standard mode to see if
there is new entry. If not the thread will sleep for 3 seconds, although it will parse the request.
Is possible that Kodi will do more than 1 request for the same file. To prevent that the script will save the
same request more than once, the last request is saved and is compered with the new one. A request is new
if is different from the previous one or if is pass at least 10 seconds from the previous one.
</pre> 
</div>
</div>
<a id="a1515866339e6d6609bc73a7f491acb5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1515866339e6d6609bc73a7f491acb5a">&#9670;&nbsp;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def reader_thread.Reader.run </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Main method of the class, first of all it will run the check of the type of the log file
and then it will run the right request parser.
</pre> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>reader_thread.py</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
