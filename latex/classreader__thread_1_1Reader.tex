\hypertarget{classreader__thread_1_1Reader}{}\doxysection{reader\+\_\+thread.\+Reader Class Reference}
\label{classreader__thread_1_1Reader}\index{reader\_thread.Reader@{reader\_thread.Reader}}
Inheritance diagram for reader\+\_\+thread.\+Reader\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classreader__thread_1_1Reader}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{classreader__thread_1_1Reader_a81ae8debea3697456ae84b58bd643b52}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, name, file)
\item 
def \mbox{\hyperlink{classreader__thread_1_1Reader_a1515866339e6d6609bc73a7f491acb5a}{run}} (self)
\item 
def \mbox{\hyperlink{classreader__thread_1_1Reader_af60097f7d3b9fc39d4ee1bf28bc55e44}{read\+\_\+file\+\_\+in\+\_\+xfrl\+\_\+mode}} (self)
\item 
def \mbox{\hyperlink{classreader__thread_1_1Reader_a047f01b347af7b675e41229fa42049be}{read\+\_\+file\+\_\+in\+\_\+std\+\_\+mode}} (self)
\item 
def \mbox{\hyperlink{classreader__thread_1_1Reader_abd599dfaed799e24698b15b3dc44dc01}{parse\+\_\+new\+\_\+line\+\_\+xfrl}} (self, line, old\+\_\+request)
\item 
def \mbox{\hyperlink{classreader__thread_1_1Reader_a51d8ba12d213d2f73c30afdf77197a3d}{parse\+\_\+new\+\_\+line\+\_\+std}} (self, line, old\+\_\+request)
\item 
def \mbox{\hyperlink{classreader__thread_1_1Reader_af7c1fa6769c40fab07cd81ec5f009c55}{check\+\_\+log\+\_\+type}} (self)
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classreader__thread_1_1Reader_a8a0e9bc7ab6d23442cd90ddefd6df4bd}\label{classreader__thread_1_1Reader_a8a0e9bc7ab6d23442cd90ddefd6df4bd}} 
{\bfseries db}
\item 
\mbox{\Hypertarget{classreader__thread_1_1Reader_a40531117d5bfb671f505bdcd914dce7e}\label{classreader__thread_1_1Reader_a40531117d5bfb671f505bdcd914dce7e}} 
{\bfseries name}
\item 
\mbox{\Hypertarget{classreader__thread_1_1Reader_a6defcad361e2f258ae0370738d57ea85}\label{classreader__thread_1_1Reader_a6defcad361e2f258ae0370738d57ea85}} 
{\bfseries file}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Represent the file-reader of the system
Attributes:
    -name: name of the file, useful to identify to which server has been done a request
    -file: represent the actual log file to read
\end{DoxyVerb}
 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classreader__thread_1_1Reader_a81ae8debea3697456ae84b58bd643b52}\label{classreader__thread_1_1Reader_a81ae8debea3697456ae84b58bd643b52}} 
\index{reader\_thread.Reader@{reader\_thread.Reader}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!reader\_thread.Reader@{reader\_thread.Reader}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def reader\+\_\+thread.\+Reader.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{name,  }\item[{}]{file }\end{DoxyParamCaption})}

\begin{DoxyVerb}This class will run the reading process from the log file.
There are 2 attributes needed:
-name: name of the vsftpd file log, used for identify the file
-file: file object where the log are stored
\end{DoxyVerb}
 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classreader__thread_1_1Reader_af7c1fa6769c40fab07cd81ec5f009c55}\label{classreader__thread_1_1Reader_af7c1fa6769c40fab07cd81ec5f009c55}} 
\index{reader\_thread.Reader@{reader\_thread.Reader}!check\_log\_type@{check\_log\_type}}
\index{check\_log\_type@{check\_log\_type}!reader\_thread.Reader@{reader\_thread.Reader}}
\doxysubsubsection{\texorpdfstring{check\_log\_type()}{check\_log\_type()}}
{\footnotesize\ttfamily def reader\+\_\+thread.\+Reader.\+check\+\_\+log\+\_\+type (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method will check in the first line of the log if it contains any of this specific words: CONNECT,
OK LOGIN, OK UPLOAD, FAIL DOWNLOAD, OK DOWNLOAD. If any of this words is inside the log line so the log is NOT
in xferlog standard mode. This method will return true if the log is in xferlog standard mode, false in any
other case
\end{DoxyVerb}
 \mbox{\Hypertarget{classreader__thread_1_1Reader_a51d8ba12d213d2f73c30afdf77197a3d}\label{classreader__thread_1_1Reader_a51d8ba12d213d2f73c30afdf77197a3d}} 
\index{reader\_thread.Reader@{reader\_thread.Reader}!parse\_new\_line\_std@{parse\_new\_line\_std}}
\index{parse\_new\_line\_std@{parse\_new\_line\_std}!reader\_thread.Reader@{reader\_thread.Reader}}
\doxysubsubsection{\texorpdfstring{parse\_new\_line\_std()}{parse\_new\_line\_std()}}
{\footnotesize\ttfamily def reader\+\_\+thread.\+Reader.\+parse\+\_\+new\+\_\+line\+\_\+std (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{line,  }\item[{}]{old\+\_\+request }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method will analise the new line of the log file (which is in standard mode), if a download is found it
will, create an object Request_std and add the new request to the database if is a new one.
\end{DoxyVerb}
 \mbox{\Hypertarget{classreader__thread_1_1Reader_abd599dfaed799e24698b15b3dc44dc01}\label{classreader__thread_1_1Reader_abd599dfaed799e24698b15b3dc44dc01}} 
\index{reader\_thread.Reader@{reader\_thread.Reader}!parse\_new\_line\_xfrl@{parse\_new\_line\_xfrl}}
\index{parse\_new\_line\_xfrl@{parse\_new\_line\_xfrl}!reader\_thread.Reader@{reader\_thread.Reader}}
\doxysubsubsection{\texorpdfstring{parse\_new\_line\_xfrl()}{parse\_new\_line\_xfrl()}}
{\footnotesize\ttfamily def reader\+\_\+thread.\+Reader.\+parse\+\_\+new\+\_\+line\+\_\+xfrl (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{line,  }\item[{}]{old\+\_\+request }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method will analise the new line of the log file (which is in xferlog standard mode), if a download
is found it will, create an object Request_xfrl and add the new request to the database if is a new one.
\end{DoxyVerb}
 \mbox{\Hypertarget{classreader__thread_1_1Reader_a047f01b347af7b675e41229fa42049be}\label{classreader__thread_1_1Reader_a047f01b347af7b675e41229fa42049be}} 
\index{reader\_thread.Reader@{reader\_thread.Reader}!read\_file\_in\_std\_mode@{read\_file\_in\_std\_mode}}
\index{read\_file\_in\_std\_mode@{read\_file\_in\_std\_mode}!reader\_thread.Reader@{reader\_thread.Reader}}
\doxysubsubsection{\texorpdfstring{read\_file\_in\_std\_mode()}{read\_file\_in\_std\_mode()}}
{\footnotesize\ttfamily def reader\+\_\+thread.\+Reader.\+read\+\_\+file\+\_\+in\+\_\+std\+\_\+mode (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method consist in a while True which will constantly check the log file (in standard mode to see if
there is new entry. If not the thread will sleep for 3 seconds, although it will parse the request.
Is possible that Kodi will do more than 1 request for the same file. To prevent that the script will save the
same request more than once, the last request is saved and is compered with the new one. A request is new
if is different from the previous one or if is pass at least 10 seconds from the previous one.
\end{DoxyVerb}
 \mbox{\Hypertarget{classreader__thread_1_1Reader_af60097f7d3b9fc39d4ee1bf28bc55e44}\label{classreader__thread_1_1Reader_af60097f7d3b9fc39d4ee1bf28bc55e44}} 
\index{reader\_thread.Reader@{reader\_thread.Reader}!read\_file\_in\_xfrl\_mode@{read\_file\_in\_xfrl\_mode}}
\index{read\_file\_in\_xfrl\_mode@{read\_file\_in\_xfrl\_mode}!reader\_thread.Reader@{reader\_thread.Reader}}
\doxysubsubsection{\texorpdfstring{read\_file\_in\_xfrl\_mode()}{read\_file\_in\_xfrl\_mode()}}
{\footnotesize\ttfamily def reader\+\_\+thread.\+Reader.\+read\+\_\+file\+\_\+in\+\_\+xfrl\+\_\+mode (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}This method consist in a while True which will constantly check the log file (in xfrelog standard mode to see if
there is new entry. If not the thread will sleep for 3 seconds, although it will parse the request.
Is possible that Kodi will do more than 1 request for the same file. To prevent that the script will save the
same request more than once, the last request is saved and is compered with the new one. A request is new
if is different from the previous one or if is pass at least 10 seconds from the previous one.
\end{DoxyVerb}
 \mbox{\Hypertarget{classreader__thread_1_1Reader_a1515866339e6d6609bc73a7f491acb5a}\label{classreader__thread_1_1Reader_a1515866339e6d6609bc73a7f491acb5a}} 
\index{reader\_thread.Reader@{reader\_thread.Reader}!run@{run}}
\index{run@{run}!reader\_thread.Reader@{reader\_thread.Reader}}
\doxysubsubsection{\texorpdfstring{run()}{run()}}
{\footnotesize\ttfamily def reader\+\_\+thread.\+Reader.\+run (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Main method of the class, first of all it will run the check of the type of the log file
and then it will run the right request parser.
\end{DoxyVerb}
 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
reader\+\_\+thread.\+py\end{DoxyCompactItemize}
